name: Weekly Marketing Summary

on:
  schedule:
    # Run every Monday at 10 AM UTC
    - cron: '0 10 * * 1'
  workflow_dispatch:

jobs:
  weekly-summary:
    name: Generate Weekly Marketing Summary
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'

      - name: Install dependencies
        run: npm install

      - name: Generate weekly summary
        run: |
          mkdir -p marketing-output

          # Generate weekly summary using echo to avoid heredoc issues
          {
            echo "# Weekly Marketing Summary - LLM PriceCompare"
            echo ""
            echo "Week of: $(date +"%B %d, %Y")"
            echo "Generated: $(date -u +"%Y-%m-%d %H:%M UTC")"
            echo ""
            echo "---"
            echo ""
            echo "## This Week's Focus"
            echo ""
            echo "### Priority 1: Directory Submissions (Days 1-3)"
            echo "Goal: Get listed on 5+ high-authority directories"
            echo ""
            echo "Action Items:"
            echo "- Submit to Futurepedia (AI directory)"
            echo "- Submit to ThereIsAnAIForThat"
            echo "- Submit to DevHunt (dev tools)"
            echo "- Submit to Product Hunt"
            echo "- Submit to BetaList"
            echo ""
            echo "Expected Impact: 5-10 backlinks, referral traffic"
            echo ""
            echo "---"
            echo ""
            echo "### Priority 2: Content Marketing (Days 3-5)"
            echo "Goal: Publish 1 blog post + 5 social posts"
            echo ""
            echo "Content Calendar:"
            echo "- Monday: Publish LLM Pricing Comparison 2026"
            echo "- Tuesday: Twitter thread on cost optimization"
            echo "- Wednesday: LinkedIn post about startup savings"
            echo "- Thursday: Reddit discussion in r/llmpricing"
            echo "- Friday: LinkedIn case study"
            echo ""
            echo "Expected Impact: SEO improvements, social engagement"
            echo ""
            echo "---"
            echo ""
            echo "### Priority 3: Outreach Campaign (Days 5-7)"
            echo "Goal: 10 personalized outreach emails"
            echo ""
            echo "Target List:"
            echo "1. AI newsletters (The Batch, AI Breakfast)"
            echo "2. Tech blogs (Hacker News, Indie Hackers)"
            echo "3. Tool directories (Futurepedia, etc.)"
            echo "4. Guest post opportunities"
            echo ""
            echo "Expected Impact: 2-3 backlinks, potential guest posts"
            echo ""
            echo "---"
            echo ""
            echo "## Metrics to Track"
            echo ""
            echo "Traffic Goals:"
            echo "- 100+ unique visitors from referrals"
            echo "- 50+ social media clicks"
            echo "- 10+ directory referrals"
            echo ""
            echo "SEO Goals:"
            echo "- 5+ new backlinks"
            echo "- Improved domain authority"
            echo "- Better keyword rankings"
            echo ""
            echo "Engagement Goals:"
            echo "- 20+ social media interactions"
            echo "- 5+ GitHub stars"
            echo "- 3+ user submissions"
            echo ""
            echo "---"
            echo ""
            echo "## Daily Checklist Template"
            echo ""
            echo "Monday: Publish blog post, share on social, submit to 2 directories"
            echo "Tuesday: Create Twitter thread, engage communities, submit to 2 directories"
            echo "Wednesday: LinkedIn post, Reddit discussion, outreach to 3 targets"
            echo "Thursday: Respond to comments, submit to 1 directory, outreach to 3 targets"
            echo "Friday: Weekly recap post, outreach to 4 targets, review metrics"
            echo ""
            echo "---"
            echo ""
            echo "## Free Marketing Channels"
            echo ""
            echo "Social Media: Twitter 1-2x daily, LinkedIn 3x/week, Reddit engagement"
            echo "Directories: Product Hunt, BetaList, Futurepedia, 20+ AI directories"
            echo "Content: Medium/Dev.to posts, guest posts, tutorials, case studies"
            echo "Community: Reddit answers, Discord/Slack help, Hacker News comments"
            echo ""
            echo "---"
            echo ""
            echo "## Success Metrics Dashboard"
            echo ""
            echo "Weekly Targets:"
            echo "- New Backlinks: 5+ (Ahrefs/Google Search Console)"
            echo "- Referral Traffic: 100+ (Google Analytics)"
            echo "- Social Engagement: 50+ (Platform analytics)"
            echo "- Directory Listings: 5+ (Manual tracking)"
            echo "- Blog Posts: 1 (Website)"
            echo "- Outreach Emails: 10 (Manual tracking)"
            echo ""
            echo "Monthly Targets:"
            echo "- Total Backlinks: 20+"
            echo "- Monthly Visitors: 500+"
            echo "- Social Followers: 100+"
            echo "- Blog Posts: 4+"
            echo "- Directory Listings: 15+"
            echo ""
            echo "---"
            echo ""
            echo "## Tools & Resources"
            echo ""
            echo "Automation Scripts:"
            echo "- scripts/marketing/social-poster.ts"
            echo "- scripts/marketing/directory-submitter.ts"
            echo "- scripts/marketing/blog-ideas.ts"
            echo "- scripts/marketing/backlink-outreach.ts"
            echo ""
            echo "Free Tools: Google Search Console, Google Analytics, Ahrefs Free, Ubersuggest, MozBar"
            echo ""
            echo "Content Ideas: LLM pricing comparisons, cost optimization guides, provider deep dives"
            echo ""
            echo "---"
            echo ""
            echo "## Pro Tips"
            echo ""
            echo "1. Leverage GitHub: Your project is open-source for credibility"
            echo "2. Data-Driven: Use daily pricing updates as content hooks"
            echo "3. Community First: Help others, don't just promote"
            echo "4. Consistency: Daily small actions > weekly big pushes"
            echo "5. Track Everything: Use a spreadsheet for outreach"
            echo ""
            echo "---"
            echo ""
            echo "## Next Week Preview"
            echo ""
            echo "Week 2 Focus: Guest post pitching, video content, newsletter creation, partnership outreach"
            echo ""
            echo "---"
            echo ""
            echo "## Support & Questions"
            echo ""
            echo "If you need help with: Customizing scripts, outreach strategies, content ideas, metrics tracking"
            echo "Check the scripts in scripts/marketing/ or review previous reports."
            echo ""
            echo "---"
            echo ""
            echo "Generated by GitHub Actions"
            echo "Automated Marketing System v1.0"
          } > marketing-output/WEEKLY_MARKETING_SUMMARY.md

          echo "## Weekly Marketing Summary Generated" >> $GITHUB_STEP_SUMMARY
          echo "✅ Focus areas defined" >> $GITHUB_STEP_SUMMARY
          echo "✅ Daily checklist created" >> $GITHUB_STEP_SUMMARY
          echo "✅ Metrics dashboard ready" >> $GITHUB_STEP_SUMMARY

      - name: Upload summary
        uses: actions/upload-artifact@v4
        with:
          name: weekly-marketing-summary-${{ github.run_number }}
          path: marketing-output/WEEKLY_MARKETING_SUMMARY.md
          retention-days: 30

      - name: Create GitHub Issue
        uses: actions/github-script@v7
        with:
          script: |
            const summary = "Weekly Marketing Plan\n\nThis week's marketing tasks are ready!\n\nQuick Start:\n1. Download the weekly summary from artifacts\n2. Follow the daily checklist\n3. Track your progress\n\nKey Goals:\n- 5+ directory submissions\n- 1 blog post\n- 10+ outreach emails\n- 100+ referral visitors\n\nTools Available:\nAll marketing scripts are in scripts/marketing/\n\nGood luck!";

            github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: "Weekly Marketing Plan - Week of " + new Date().toLocaleDateString(),
              body: summary,
              labels: ['marketing', 'weekly']
            });
